(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f557f66"],{"1f69":function(e,t,n){},2303:function(e,t,n){"use strict";var r=n("471b"),o=n.n(r);o.a},"471b":function(e,t,n){},"51c9":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"create-project-container"},[n("dofine-project-title"),e.typeOfCheck||e.typeOfCreate?e._e():n("router-link",{attrs:{to:{name:"项目模板"}}},[n("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{plain:"",size:"small",type:"primary"}},[e._v("\n            从模板建立\n        ")])],1),n("el-form",{ref:"form",attrs:{model:e.project,"label-width":"80px",rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[n("el-input",{staticClass:"el-inputer",model:{value:e.project.name,callback:function(t){e.$set(e.project,"name",t)},expression:"project.name"}})],1),n("el-form-item",{attrs:{label:"项目类型",prop:"type"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.project.type,callback:function(t){e.$set(e.project,"type",t)},expression:"project.type"}},e._l(e.project.projectTypeOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),n("dofine-time-picker",{attrs:{message:e.project,workDay:e.workDay,countWorkDayKey:e.countWorkDayKey,label:"项目时间"},on:{"update:workDay":function(t){e.workDay=t},"update:work-day":function(t){e.workDay=t},"update:countWorkDayKey":function(t){e.countWorkDayKey=t},"update:count-work-day-key":function(t){e.countWorkDayKey=t},formValidateField:e.formValidateField}}),e.typeOfCheck?n("el-form-item",{attrs:{label:"项目类型",required:""}},[n("el-radio-group",{model:{value:e.project.state,callback:function(t){e.$set(e.project,"state",t)},expression:"project.state"}},[n("el-radio",{attrs:{label:"executing"}},[e._v("开始")]),n("el-radio",{attrs:{label:"stoped"}},[e._v("暂停")]),n("el-radio",{attrs:{label:"finished"}},[e._v("结束")])],1)],1):e._e()],1),e.typeOfCheck?n("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:e.openForm}},[e._v("项目凭证")]):e._e(),n("dofine-resource",{attrs:{resourceData:e.resourceData},on:{"update:resourceData":function(t){e.resourceData=t},"update:resource-data":function(t){e.resourceData=t},getUserData:e.getUserData,newResourceInfo:e.newResourceInfo}}),e.typeOfCheck||e.typeOfCreate?e._e():n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.createProject}},[e._v("创建项目")]),!e.typeOfCheck&&e.typeOfCreate?n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.createProject}},[e._v("创建模板")]):e._e(),e.typeOfCheck?n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.saveAsAnotherTemplete}},[e._v("另存模板")]):e._e(),e.typeOfCheck?n("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:e.upDateProject}},[e._v("更新项目")]):e._e(),n("transition",{attrs:{name:"el-fade-in"}},[e.exForm?n("dofine-licence",{attrs:{open:e.exForm},on:{"update:open":function(t){e.exForm=t}}}):e._e()],1)],1)},o=[],i=(n("2338"),n("f763"),n("fb37"),n("3c6b"),n("7c56"),n("f301"),n("df99"),n("7364"),n("a506")),a=(n("7bc1"),n("4ec3")),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"licence",staticClass:"dofine-licence-container"},[n("div",{staticClass:"dofine-licence-header",on:{mousedown:e.move}},[n("span",{staticClass:"title"},[e._v("\n            "+e._s(e.licenceInfo.title)+"\n        ")]),n("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.close(t)}}})]),n("div",{staticClass:"dofine-licence-wrapper"},[n("div",{staticClass:"scrollbar-container"},[n("table-one")],1)])])},s=[],u=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},l=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticClass:"table-info"},[n("tbody",[n("tr",[n("th",[e._v("收文编号")]),n("td",[e._v("2013004205M")])]),n("tr",[n("th",[e._v("发证机关")]),n("td",[e._v("佛山市国土资源和城乡规划局")])]),n("tr",[n("th",[e._v("证书编号")]),n("td",[e._v("440605201360472")])]),n("tr",[n("th",[e._v("出证日期")]),n("td",[e._v("2013年08月08日")])]),n("tr",[n("th",[e._v("建筑单位(个人)")]),n("td",[e._v("李伟章")])]),n("tr",[n("th",[e._v("项目名称")]),n("td",[e._v("丽湖花园住宅")])]),n("tr",[n("th",[e._v("建筑位置")]),n("td",[e._v("松岗工业城")])]),n("tr",[n("th",[e._v("建筑面积(㎡)")]),n("td",[e._v("806.47")])]),n("tr",[n("th",[e._v("地上层数")]),n("td",[e._v("3")])]),n("tr",[n("th",[e._v("地下层数")]),n("td",[e._v("1")])]),n("tr",[n("th",[e._v("地下室面积")]),n("td",[e._v("229.33")])]),n("tr",[n("th",[e._v("管径")]),n("td")]),n("tr",[n("th",[e._v("管线长")]),n("td")]),n("tr",[n("th",[e._v("占路面面积(㎡)")]),n("td")]),n("tr",[n("th",[e._v("附图与附件名称")]),n("td",[e._v("计容建筑面积577.14㎡")])]),n("tr",[n("th",[e._v("其他1")]),n("td",[e._v("取得建筑工程规划许可证后一年尚未开")])])])])}],f={name:"one",components:{},filter:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{}},p=f,d=n("6691"),m=Object(d["a"])(p,u,l,!1,null,"4e1d2e50",null),h=m.exports,b={name:"dofineLicence",components:{tableOne:h},filter:{},props:{open:{default:!1,type:!0}},data:function(){return{licenceInfo:{title:"《建筑工程许可证》信息",receiving:"2013004205M",licensing:"佛山市国土资源和城乡规划局",certificate:440605201360472,date:"2013-08-08",construction:"李伟章",name:"丽湖花园住宅",location:"松岗工业城",area:806.47,ceil:3,floors:1,basement:229.33,pipediameter:"",pipelinelength:"",occupy:"",enclosure:"计容建筑面积577.14㎡",other:[{content:"取得建筑工程规划许可证后一年尚未开"}]}}},computed:{},watch:{},created:function(){},mounted:function(){},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{close:function(){this.$emit("update:open",!1)},move:function(e){var t=this.$refs.licence,n=document.getElementsByTagName("body")[0],r=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop;document.onmousemove=function(e){var i=e.clientX-r,a=e.clientY-o,c=n.offsetWidth-t.offsetWidth,s=n.offsetHeight-t.offsetHeight,u=i,l=a;u>c?u=c:u<0&&(u=0),l>s?l=s:l<0&&(l=0),t.style.left=u+"px",t.style.top=l+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},y=b,v=(n("ba9f"),Object(d["a"])(y,c,s,!1,null,null,null)),g=v.exports,k=function(){var e=this,t=this,n=t.$createElement,r=t._self._c||n;return r("div",{attrs:{id:"resource"}},[r("div",{staticClass:"info-enter-box"}),r("div",{staticClass:"resource-container"},[r("h3",{staticClass:"title"},[t._v("人员架构")]),r("el-button",{staticClass:"add-button",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.showAddResource}},[t._v("添加工作组")]),r("el-button",{staticClass:"add-button",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.openArchitectureMap}},[t._v("人员架构图")]),r("el-table",{staticClass:"el-table",staticStyle:{width:"100%"},attrs:{data:t.resourceData,border:""}},[r("el-table-column",{attrs:{prop:"name",label:"工作组","min-width":"100%"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index!==t.sourceNameInputKey?r("span",{on:{click:function(n){return t.modifyName(e.$index)}}},[t._v(t._s(e.row.name))]):t._e(),e.$index===t.sourceNameInputKey?r("el-input",{ref:"sourceNameInput",attrs:{size:"small"},on:{blur:t.resourseNameInput},model:{value:e.row.name,callback:function(n){t.$set(e.row,"name",n)},expression:"scope.row.name"}}):t._e()]}}])}),r("el-table-column",{attrs:{prop:"member",label:"用户","min-width":"150%"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.user,function(n,o){return r("el-tag",{key:o,staticClass:"dofine-el-tag",attrs:{closable:!n.mustExist},on:{close:function(r){return t.deleteResourceUser(e.row,n.id)}}},[t._v("\r\n                            "+t._s(n.name)+"\r\n                        ")])})}}])}),r("el-table-column",{attrs:{label:"操作","min-width":"150%"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("dofine-button",{staticClass:"dofine-button",attrs:{backgroundColor:"ffc577"},nativeOn:{click:function(n){return t.openDofineMember(e)}}},[t._v("修改用户")]),0!==e.$index?r("dofine-button",{attrs:{backgroundColor:"f18686"},nativeOn:{click:function(n){return t.deleteResourceInfo(e)}}},[t._v("删除")]):t._e()]}}])})],1)],1),t.dofineAddResource||t.architectureMapKey?r("div",{staticClass:"dofine-add-resource-curtain",on:{click:function(){e.closeAddResource(!1),e.$refs.architectureMap.close()}}}):t._e(),r("transition",{attrs:{name:"dofine-fade-in"}},[t.architectureMapKey?r("architecture-map",{directives:[{name:"drag",rawName:"v-drag"}],ref:"architectureMap",attrs:{architectureMapKey:t.architectureMapKey,resourceData:t.resourceData},on:{"update:architectureMapKey":function(e){t.architectureMapKey=e},"update:architecture-map-key":function(e){t.architectureMapKey=e}}}):t._e()],1),r("transition",{attrs:{name:"el-zoom-in-top"}},[t.dofineAddResource?r("dofine-add-resource",{on:{closeAddResource:t.closeAddResource,newResourceInfo:t.newResourceInfo}}):t._e()],1),t.dofineMemberOpen?r("div",{staticClass:"curtain",on:{click:function(){e.closeMember()}}}):t._e(),t.dofineMemberOpen?r("dofine-member",{attrs:{beforeSelectedUsers:t.beforeSelectedUsers,single:t.single},on:{closeMember:t.closeMember,getUserData:t.getUserData}}):t._e()],1)},j=[],C=n("873c"),_=n("3bb1"),w=n("6b43"),D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"add-resourse-container clearfix"},[n("div",{staticClass:"add-resourse-left"},[n("h2",{staticClass:"title"},[e._v("添加项目组")]),n("h4",{staticClass:"title-en"},[e._v("PROJECT TEAM")]),n("button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.dofineCopyAnotherTemplate}},[e._v("从其他项目导入")]),n("button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.openDofineMember}},[e._v("添加成员")])]),n("div",{staticClass:"add-resourse-right"},[n("div",{staticClass:"clearfix"},[n("i",{staticClass:"add-resourse-el-icon-close el-icon-close",on:{click:e.close}})]),n("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"项目组名称：",prop:"name","label-width":"120px"}},[n("el-input",{ref:"resouceInput",model:{value:e.resourceValue,callback:function(t){e.resourceValue=t},expression:"resourceValue"}})],1)],1),n("div",{staticClass:"add-resourse-resouce-member"},[n("el-table",{staticClass:"el-table",staticStyle:{width:"100%"},attrs:{data:e.user,border:""}},[n("el-table-column",{attrs:{prop:"name",label:"项目成员","min-width":"300%"}}),n("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("dofine-button",{attrs:{backgroundColor:"f18686"},nativeOn:{click:function(n){return e.deleteResourceInfo(t)}}},[e._v("删除")])]}}])})],1)],1),n("button",{staticClass:"add-resourse-submit",on:{click:e.submit}},[e._v("确定")])],1),n("dofine-dialog",{attrs:{button:!1,height:444,width:582,visible:e.dofineCopyAnotherTemplateKey},on:{"update:visible":function(t){e.dofineCopyAnotherTemplateKey=t}}},[e.dofineCopyAnotherTemplateKey?n("dofine-copy-another-template",{attrs:{slot:"body",visible:e.dofineCopyAnotherTemplateKey,name:e.resourceValue,user:e.user},on:{"update:visible":function(t){e.dofineCopyAnotherTemplateKey=t},"update:name":function(t){e.resourceValue=t},"update:user":function(t){e.user=t},close:e.close},slot:"body"}):e._e()],1),e.dofineMemberOpen?n("dofine-member",{attrs:{beforeSelectedUsers:e.user},on:{closeMember:e.closeMember,getUserData:e.getUserData}}):e._e()],1)},O=[],x=n("58f4"),$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dofine-copy-another-template-container"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}],ref:"coypAnotherScroll",staticClass:"dofine-copy-another-template-wrapper"},[n("div",{staticClass:"dofine-copy-another-template-box"},[e._l(e.projectList,function(t){return n("div",{key:t.id,staticClass:"list",on:{click:function(n){return e.importMsg(t)}}},[n("span",{staticClass:"title"},[n("i",{staticClass:"el-icon-tickets"}),e._v(e._s(t.name))]),n("span",{staticClass:"time"},[e._v(e._s(t.start))])])}),e.loading?n("div",{staticClass:"loading"},[n("i",{staticClass:"el-icon-loading"}),e._v("尝试加载更多数据")]):e._e(),e.noMoreTip?n("div",{staticClass:"no-more-tip"},[e._v("已经加载全部数据")]):e._e()],2)]),e.detailWrapper?n("div",{staticClass:"dofine-copy-another-template-detail-wrapper"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.currentProjectInfo,height:"350",size:"mini"}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",e._l(t.row.user,function(t,r){return n("el-tag",{key:r,staticClass:"dofine-copy-another-template-detail-tag"},[e._v(e._s(t.name))])}),1)]}}],null,!1,1078210967)}),n("el-table-column",{attrs:{prop:"name",label:"工作组名称"}}),n("el-table-column",{attrs:{prop:"name",label:"操作",width:"120"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(){e.detailWrapper=!1}}},[e._v("\n                                返回\n                            ")])]}},{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.importResource(t.row)}}},[e._v("\n                                选择\n                            ")])]}}],null,!1,3611849520)})],1)],1):e._e(),e.replicaCheckbox?e._e():n("div",[n("span",{staticClass:"dofine-copy-another-page"},[e._v("总共 2 页")]),n("el-pagination",{staticClass:"dofine-copy-another-pagination",attrs:{"current-page":e.currentPage,"page-size":e.totalPage,layout:"jumper"},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.currentChange}})],1),e.replicaCheckbox?n("replica-checkbox",{attrs:{data:e.currentProjectInfo,visible:e.replicaCheckbox},on:{"update:visible":function(t){e.replicaCheckbox=t},confirm:e.confirmCopy}}):e._e(),e.replicaCheckbox?n("div",{staticClass:"replica-checkbox-confirm-button"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.confirmAdd}},[e._v("\n                    添加\n                ")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.confirmCopy}},[e._v("\n                    覆盖\n                ")])],1):e._e()],1)},T=[],P=(n("63ff"),n("e71e")),M=n("ecd2"),A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"el-fade-in-linear"}},[n("div",{staticClass:"replica-checkbox-container"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data,height:"350",size:"mini","header-cell-style":{padding:"10px 0",color:"#333",fontWeight:700}}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",e._l(t.row.user,function(r,o){return n("el-tag",{key:o,staticClass:"replica-checkbox-container-tag",attrs:{closable:!r.mustExist,effect:"plain"},on:{close:function(n){return e.deleteUser(t,r)}}},[e._v(e._s(r.name))])}),1)]}}])}),n("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-switch",{staticClass:"replica-checkbox-header-switch",attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.selectionAll,callback:function(t){e.selectionAll=t},expression:"selectionAll"}})]}},{key:"default",fn:function(t){return[n("el-switch",{staticClass:"replica-checkbox-row-switch",attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.allDetermineState},model:{value:t.row.selection,callback:function(n){e.$set(t.row,"selection",n)},expression:"scope.row.selection"}})]}}])}),n("el-table-column",{attrs:{type:"index",label:"ID"}}),n("el-table-column",{attrs:{label:"项目组名称","min-width":"200",prop:"name"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("span",{staticClass:"replica-checkbox-table-header"},[n("span",{on:{click:e.confirm}},[e._v(e._s(t.column.label))]),n("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.close}},[e._v("返回")])],1)]}}])})],1)],1)])},R=[],S={name:"ReplicaCheckbox",components:{},filter:{},props:{data:{default:function(){return[]},type:Array},visible:{default:!1,type:Boolean}},data:function(){return{selectionAll:!0}},computed:{stateSelectionAll:function(){return this.data.every(function(e){return e.selection})},stateNotSelectionAll:function(){return this.data.every(function(e){return!e.selection})}},watch:{selectionAll:function(e){var t=this;this.data.forEach(function(n){t.$set(n,"selection",e)})}},created:function(){},mounted:function(){},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{deleteUser:function(e,t){var n=e.row.user.filter(function(e){return e.id!==t.id});this.$set(e.row,"user",n)},close:function(){this.$emit("update:visible",!1)},confirm:function(){console.log(this.data)},allDetermineState:function(){this.stateSelectionAll?this.selectionAll=!0:this.stateNotSelectionAll&&(this.selectionAll=!1)}}},E=S,I=(n("7ee6"),Object(d["a"])(E,A,R,!1,null,null,null)),U=I.exports;function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach(function(t){Object(i["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var W={name:"dofineCopyAnotherTemplate",components:{ReplicaCheckbox:U},filter:{},inject:["root"],props:{show:{default:!1,type:Boolean},visible:{default:!0,type:Boolean},name:{default:"",type:String},user:{default:function(){return[]},type:Array}},data:function(){return{currentPage:1,page:1,projectList:[],totalPage:1,loading:!1,mainLoading:!0,currentProjectInfo:[],detailWrapper:!1,replicaCheckbox:!1}},computed:{noMoreTip:function(){return this.page===this.totalPage},projectListWrapperHeight:function(){return 40*this.projectList.length-370}},watch:{},created:function(){this.requireProjectListInfo(this.page)},mounted:function(){var e=this;this.$nextTick(function(){e.coypAnotherScroll=new M["a"](e.$refs.coypAnotherScroll,{probeType:3,click:!0,mouseWheel:!0,scrollbar:{fade:!0,interactive:!0}}),e.coypAnotherScroll.on("scroll",function(t){Math.abs(t.y)>=e.projectListWrapperHeight&&!e.loading&&e.page!==e.totalPage&&(e.loading=!0,e.requireProjectListInfo(e.page+1).then(function(){e.loading=!1}))})})},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{requireProjectListInfo:function(){var e=Object(P["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){n.axios.post(a["h"],{page:t}).then(function(t){setTimeout(function(){var r;n.page=t.data.data.currentPage,n.totalPage=t.data.data.totalPage,(r=n.projectList).push.apply(r,Object(C["a"])(t.data.data.list)),n.mainLoading=!1,e()},1e3)}).catch(function(e){console.error(e),r("fail")})}));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),close:function(){this.$emit("update:visible",!1)},importMsg:function(e){var t=this;this.currentProjectInfo=JSON.parse(JSON.stringify(e.source)).map(function(e){return N({},e,{selection:!0})}),this.$confirm("请选择要将信息置入的位置","提示",{distinguishCancelAndClose:!0,confirmButtonText:"添加填写表格",cancelButtonText:"人员架构表格",type:"warning"}).then(function(){t.$message({type:"success",message:"读取成功"}),t.detailWrapper=!0}).catch(function(e){"cancel"===e?t.replicaCheckbox=!0:t.$message({type:"info",message:"已取消操作"})})},confirmAdd:function(){this.$set(this.root,"resourceData",[].concat(Object(C["a"])(this.root.resourceData),Object(C["a"])(this.currentProjectInfo.filter(function(e){return e.selection&&"项目经理"!==e.name})))),this.$emit("close")},confirmCopy:function(){this.$set(this.root,"resourceData",this.currentProjectInfo.filter(function(e){return e.selection})),this.$emit("close")},importResource:function(e){var t=this;"项目经理"===e.name?this.$confirm("你选择的项目组为项目经理，是否直接将其信息覆盖到当前项目？","提示",{distinguishCancelAndClose:!0,confirmButtonText:"摘取",cancelButtonText:"覆盖",type:"warning"}).then(function(){var n=e.user.map(function(e){return N({},e,{mustExist:0})});t.$emit("update:name",e.name),t.$emit("update:user",n),t.close()}).catch(function(n){"cancel"===n?(t.$set(t.root.resourceData[0],"user",e.user),t.$emit("close")):t.$message({type:"info",message:"已取消操作"})}):(this.$emit("update:name",e.name),this.$emit("update:user",e.user),this.close())},currentChange:function(){this.mainLoading=!0,this.projectList=[],this.currentPage=this.currentPage>this.totalPage?this.totalPage:this.currentPage,this.requireProjectListInfo(this.currentPage)}}},F=W,L=(n("5e94"),Object(d["a"])(F,$,T,!1,null,"6ec0ee20",null)),q=L.exports,z={name:"addResource",components:{dofineMember:w["a"],dofineButton:_["a"],dofineCopyAnotherTemplate:q,DofineDialog:x["a"]},filter:{},props:{},data:function(){return{resourceValue:"",user:[],dofineMemberOpen:!1,dofineCopyAnotherTemplateKey:!1,rules:{name:[{required:!0,message:"请输入项目组名称",trigger:"blur"}]}}},computed:{resouce:function(){return{name:this.resourceValue,user:Object(C["a"])(this.user)}},ruleForm:function(){return{name:this.resourceValue}}},watch:{},created:function(){},mounted:function(){},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{close:function(){this.$emit("closeAddResource",!1)},submit:function(){this.resouce.name?(this.$emit("newResourceInfo",this.resouce),this.close()):(this.$refs.form.validate(),this.$refs.resouceInput.focus())},getUserData:function(e){this.user=e},deleteResourceInfo:function(e){var t=this.user;t.splice(e.$index,1),this.user=t},openDofineMember:function(){this.dofineMemberOpen=!this.dofineMemberOpen},closeMember:function(){this.dofineMemberOpen=!1},dofineCopyAnotherTemplate:function(){this.dofineCopyAnotherTemplateKey=!this.dofineCopyAnotherTemplateKey}}},B=z,V=(n("bec8"),Object(d["a"])(B,D,O,!1,null,null,null)),H=V.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"resource-architecture-map-container"},[n("div",{staticClass:"curtain",on:{click:e.close}}),n("div",{staticClass:"header v-drag-header"},[n("h3",{staticClass:"title"},[e._v(e._s(e.projectTitle))]),n("i",{staticClass:"el-icon-close",on:{click:e.close}})]),n("div",{staticClass:"scroll-bar-box"},[n("div",{ref:"architectureMapBScroll",staticClass:"resource-architecture-map-wrapper"},[n("div",{ref:"architectureMapEcharts",staticClass:"resource-architecture-map-echarts",style:{height:this.resourceHeight}})])])])},Y=[],X=n("a78f"),G=n.n(X);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(n,!0).forEach(function(t){Object(i["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ee={name:"architectureMap",components:{},filter:{},inject:["root"],props:{resourceData:{default:function(){return[{name:"未知",group:[]}]},type:Array},architectureMapKey:{default:!1,type:Boolean}},data:function(){return{}},computed:{echartsData:function(){return{name:this.projectTitle,children:[{name:"项目经理",label:{fontSize:16,color:"#000",fontWeight:700},itemStyle:{color:"red",borderColor:"red",borderWidth:3,normal:{color:"red"}},children:[Z({},this.resourceData[0].user[0],{itemStyle:{color:"red",borderColor:"red",borderWidth:3,normal:{color:"red"}}})]}].concat(Object(C["a"])(this.anotherResourceFormat))}},anotherResource:function(){return JSON.parse(JSON.stringify(this.resourceData.filter(function(e,t){return 0!==t})))},anotherResourceFormat:function(){return this.anotherResource.map(function(e){return{name:e.name,itemStyle:{color:"#71cbf3",borderColor:"#71cbf3",borderWidth:3,normal:{color:"#71cbf3"}},children:e.user.map(function(e){return{name:e.name,group:e.group,role:e.role,itemStyle:{color:"#71cbf3",borderColor:"#71cbf3",borderWidth:3,normal:{color:"#71cbf3"}}}})}})},resourceHeight:function(){var e=0;return this.anotherResourceFormat.forEach(function(t){e+=t.children.length}),"".concat(24*e,"px")},projectTitle:function(){return this.root.project.name?this.root.project.name:"项目名称"}},watch:{},created:function(){},mounted:function(){var e=this;this.$nextTick(function(){e.initEcharts()})},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{initEcharts:function(){this.architectureMapEcharts=G.a.init(this.$refs.architectureMapEcharts,"westeros"),this.architectureMapEcharts.setOption({tooltip:{trigger:"item",triggerOn:"mousemove",formatter:function(e){if(!e.data.children){for(var t="成员:".concat(e.name,"</br>"),n=e.data.group.map(function(e){return e.name}),r="",o=0;o<n.length;o++)0!==o&&(r+="、"),r+=n[o];t+="所属部门:".concat(r,"</br>");for(var i=e.data.role.map(function(e){return e.name}),a="",c=0;c<i.length;c++)0!==c&&(a+="、"),a+=i[c];return t+="角色:".concat(a),t}}},series:[{type:"tree",initialTreeDepth:-1,data:[this.echartsData],top:"40",left:"10%",bottom:"1%",right:"10%",symbolSize:10,label:{normal:{position:"left",verticalAlign:"middle",align:"right",color:"black"}},leaves:{label:{normal:{position:"right",verticalAlign:"middle",align:"left"}},itemStyle:{normal:{color:{type:"radial",x:.5,y:.5,r:.5,colorStops:[{offset:0,color:"red"},{offset:1,color:"blue"}],globalCoord:!1}}}},expandAndCollapse:!0,animationDuration:550,animationDurationUpdate:750}]})},close:function(){this.$emit("update:architectureMapKey",!1)}}},te=ee,ne=(n("531f"),Object(d["a"])(te,J,Y,!1,null,null,null)),re=ne.exports,oe={name:"resource",components:{dofineButton:_["a"],dofineAddResource:H,dofineMember:w["a"],architectureMap:re},filter:{},props:{resourceData:{default:function(){return[]},type:Array}},data:function(){return{dofineAddResource:!1,dofineMemberOpen:!1,resource:[],beforeSelectedUsers:[],chooseResourNum:0,resourceDataActuall:[],single:!1,sourceNameInputKey:"",architectureMapKey:!1}},computed:{},watch:{},created:function(){},mounted:function(){},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{showAddResource:function(){this.dofineAddResource=!0,this.dofineMemberOpen=!1},closeAddResource:function(e){this.dofineAddResource=e},openDofineMember:function(e){this.single=0===e.$index;var t=e.row.user||[];this.chooseResourNum=e.$index,this.beforeSelectedUsers=Object(C["a"])(t),this.dofineMemberOpen=!0},newResourceInfo:function(e){this.$emit("newResourceInfo",e)},deleteResourceInfo:function(e){var t=this;this.$confirm("此操作将删除选中的工作组信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n=t.resourceData;n.splice(e.$index,1),t.resourceData=n,t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},closeMember:function(){this.dofineMemberOpen=!1},getUserData:function(e){this.$emit("getUserData",e,this.chooseResourNum)},resourseNameInput:function(){this.sourceNameInputKey=""},modifyName:function(e){var t=this;0!==e&&(this.sourceNameInputKey=e,setTimeout(function(){t.$refs.sourceNameInput.focus()},100))},openArchitectureMap:function(){this.architectureMapKey=!0},deleteResourceUser:function(e,t){var n=e.user.filter(function(e){return e.id!==t});this.$set(e,"user",n)}}},ie=oe,ae=(n("2303"),n("891c"),Object(d["a"])(ie,k,j,!1,null,"e0259ac0",null)),ce=ae.exports,se=n("7de9"),ue=n("1817");function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(n,!0).forEach(function(t){Object(i["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var pe={},de=["2018-12-30","2019-01-01","2019-02-04","2019-02-05","2019-02-06","2019-02-07","2019-02-08","2019-04-05","2019-04-06","2019-04-07","2019-05-01","2019-05-02","2019-05-03","2019-05-04","2019-06-07","2019-06-08","2019-06-09","2019-09-13","2019-09-14","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2020-01-24","2020-01-25","2020-01-26","2020-01-27","2020-01-28","2020-01-29","2020-01-30","2020-04-04","2020-04-05","2020-04-06","2020-05-01","2020-05-02","2020-05-03","2020-06-25","2020-06-26","2020-06-27","2020-10-01","2020-10-02","2020-10-03","2020-10-04","2020-10-05","2020-10-06","2020-10-07"],me=["2019-02-02","2019-02-03","2019-04-28","2019-05-05","2019-09-29","2019-10-12","2020-01-19","2020-02-01","2020-06-28"],he={},be={};function ye(e,t){var n,r;return e=Date.parse(e),t=Date.parse(t),n=t-e,r=Math.floor(n/864e5),r}function ve(e,t){for(var n=0;n<e.length;n++)he[e[n]]="1";for(var r=0;r<t.length;r++)be[t[r]]="1"}function ge(e){return parseInt(e,10)<10?"0"+e:e}function ke(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+"-"+ge(n)+"-"+ge(r)}function je(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=e.split("-"),i=new Date;i.setUTCFullYear(o[0],o[1]-1,o[2]),i.setUTCHours(0,0,0,0);for(var a=i.getTime(),c=1;c<=t;c++)if(a+=864e5*n,i.setTime(a),0==i.getDay()||6==i.getDay()){var s=ke(i);be[s]||c--}else{var u=ke(i);he[u]&&c--}return r?ke(i):a}var Ce={name:"dofineProjectInfo",components:{dofineResource:ce,dofineProjectTitle:se["a"],dofineLicence:g,dofineTimePicker:ue["a"]},filter:{},props:{},provide:function(){var e={},t=this;return Object.defineProperty(e,"root",{enumerable:!0,get:function(){return t}}),e},data:function(){return{project:{projectTypeOptions:[{label:"国土",value:"0"},{label:"市政",value:"1"},{label:"拆迁",value:"2"},{label:"其他",value:"3"}],name:"",type:"",start:"",end:"",state:"",time:""},originalTime:{start:"",end:""},rules:{name:{required:!0,validator:this.valiNameRuler,trigger:"blur"},start:{required:!0,message:"请选择日期",trigger:"change"},end:{validator:this.validateRuler,trigger:"change"},type:{required:!0,message:"请选择项目类型",trigger:"change"}},startPickerOptions:{shortcuts:[{text:"今天",onClick:function(e){var t=new Date;e.$emit("pick",t)}},{text:"一星期后",onClick:function(e){var t=new Date;this.onlyWorkDay?t.setTime(je(ke(t),7)):t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}},{text:"半个月后",onClick:function(e){var t=new Date;this.onlyWorkDay?t.setTime(je(ke(t),15)):t.setTime(t.getTime()+1296e6),e.$emit("pick",t)}},{text:"一个月后",onClick:function(e){var t=new Date;this.onlyWorkDay?t.setTime(je(ke(t),30)):t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}}]},endPickerOptions:{shortcuts:[{text:"距开始日期"},{text:"一个月",onClick:function(e){pe.quicklyChooseTimer(e,1)}},{text:"三个月",onClick:function(e){pe.quicklyChooseTimer(e,3)}},{text:"六个月",onClick:function(e){pe.quicklyChooseTimer(e,6)}},{text:"一年",onClick:function(e){pe.quicklyChooseTimer(e,12)}}]},resourceData:[{name:"项目经理",managerUserId:this.$store.state.user.user.id,user:[fe({},this.$store.state.user.user,{mustExist:1})]}],exForm:!1,onlyWorkDay:!0,workDay:0,countWorkDayKey:!0,originalMissionLists:[]}},computed:{projectType:function(){return"创建模板"===this.$route.name},typeOfCheck:function(){return Boolean(this.$route.params.check)},startDate:function(){return this.getFormatDate(this.project.start)},endDate:function(){return this.getFormatDate(this.project.end)},typeOfCreate:function(){return this.$route.path.includes("templete")},originStartDate:function(){return this.project.start},originEndDate:function(){return this.project.end}},watch:{originStartDate:function(e,t){t||(this.originalTime.start=e)},originEndDate:function(e,t){t||(this.originalTime.end=e)},workDay:function(e){this.workDay=parseInt(e),(!e||e<0)&&(this.workDay=0)}},created:function(){var e=this;if(ve(de,me),pe=this,this.$route.params.msg){var t=this.$route.params.msg;this.project.name=t.name,this.project.type=t.type,this.project.start=t.start,this.project.end=t.end,this.resourceData=t.source}this.axios.get(a["a"]).then(function(t){e.originalMissionLists=t.data.missions})},mounted:function(){},activited:function(){},update:function(){},beforeRouteUpdate:function(){},methods:{saveAsAnotherTemplete:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.$confirm("是否需要另存为项目模板？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"创建后添加任务",cancelButtonText:"直接创建"}).then(function(){e.projectType?e.$router.push({name:"任务创建",query:{id:283}}):e.$router.push({name:"任务创建",query:{type:"templete",id:86}}),e.$notify({title:"成功",message:"模板".concat(e.project.name,"已创建成功"),type:"success"})}).catch(function(t){"cancel"===t&&(e.$notify({title:"成功",message:"项目".concat(e.project.name,"已创建成功"),type:"success"}),e.projectType?e.$router.push({name:"项目模板",query:{type:"templete",id:86}}):e.$router.push({name:"项目列表",query:{id:283}}))})})},createProject:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.$confirm("是否需要为项目创建任务？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"创建后添加任务",cancelButtonText:"直接创建"}).then(function(){e.projectType?e.$router.push({name:"任务创建",query:{type:"templete",id:86}}):e.$router.push({name:"任务创建",query:{id:283}}),e.$notify({title:"成功",message:"项目".concat(e.project.name,"已创建成功"),type:"success"})}).catch(function(t){"cancel"===t&&(e.$notify({title:"成功",message:"项目".concat(e.project.name,"已创建成功"),type:"success"}),e.projectType?e.$router.push({name:"项目模板",query:{type:"templete",id:86}}):e.$router.push({name:"项目列表",query:{id:283}}))})})},formValidateField:function(){this.$refs.form.validateField(["start","end"])},getUserData:function(e,t){this.resourceData[t].user=e},newResourceInfo:function(e){this.resourceData.push(e)},countDate:function(e,t){var n=ye(e,t)<0?-1:1,r=e.split("-"),o=new Date,i=Math.abs(ye(e,t)),a=0;o.setUTCFullYear(r[0],r[1]-1,r[2]),o.setUTCHours(0,0,0,0);for(var c=o.getTime(),s=1;s<=i;s++)if(c+=864e5*n,o.setTime(c),0==o.getDay()||6==o.getDay()){var u=ke(o);be[u]&&(a+=1)}else{var l=ke(o);he[l]||(a+=1)}return a},setWorkDay:function(){if(this.project.start||this.$set(this.project,"start",this.getFormatDate(new Date)),this.onlyWorkDay){var e=this.newDate();e.setTime(je(this.project.start,this.workDay)),this.project.end=e}},newDate:function(){var e=new Date,t=pe.project.start.slice(0,4),n="".concat(pe.project.start.slice(5,6)).concat(pe.project.start.slice(6,7)-1),r=pe.project.start.slice(8,10);return e.setDate(r),e.setMonth(n),e.setFullYear(t),e},getFormatDate:function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0".concat(r):r)},validateRuler:function(e,t,n){if(t)if(this.project.start){var r=new Date(this.project.start),o=new Date(this.project.end);Date.parse(o)-Date.parse(r)>=0?n():n(new Error("选择的结束时间不允许超过开始时间"))}else n(new Error("请先选择项目开始时间"));else n(new Error("请选择结束时间"))},valiNameRuler:function(e,t,n){var r=new RegExp(/\s/g),o=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\]\\~.<>/?！@#￥……&*（）——|{}【】'？]");t?t.match(r)?n(new Error("请勿输入空格")):t.match(o)?n(new Error("请勿输入特殊字符")):n():n(new Error("项目名称不许为空"))},openForm:function(){this.exForm=!0},countMissionTime:function(){if(this.project.start&&this.project.end&&ye(this.project.start,this.project.end)>=0){var e=ye(this.originalTime.end,this.project.end)<0?-1:1,t=ye(this.originalTime.start,this.project.start)<0?-1:1,n=this.countDate(this.originalTime.end,this.project.end),r=this.countDate(this.originalTime.start,this.project.start);return this.originalMissionLists.map(function(o){return fe({},o,{startDate:o.startDate?je(o.startDate,r,t,!0):"",endDate:o.endDate?je(o.endDate,n,e,!0):""})})}},upDateProject:function(){console.log(this.countMissionTime()),this.originalTime.end=this.project.end}}},_e=Ce,we=(n("8258"),Object(d["a"])(_e,r,o,!1,null,null,null));t["a"]=we.exports},"531f":function(e,t,n){"use strict";var r=n("1f69"),o=n.n(r);o.a},"5bcb":function(e,t,n){},"5d34":function(e,t,n){},"5e94":function(e,t,n){"use strict";var r=n("c167"),o=n.n(r);o.a},6278:function(e,t,n){},"7ee6":function(e,t,n){"use strict";var r=n("5d34"),o=n.n(r);o.a},8258:function(e,t,n){"use strict";var r=n("6278"),o=n.n(r);o.a},"891c":function(e,t,n){"use strict";var r=n("5bcb"),o=n.n(r);o.a},b246:function(e,t,n){},b9f7:function(e,t,n){},ba9f:function(e,t,n){"use strict";var r=n("b246"),o=n.n(r);o.a},bec8:function(e,t,n){"use strict";var r=n("b9f7"),o=n.n(r);o.a},c167:function(e,t,n){}}]);